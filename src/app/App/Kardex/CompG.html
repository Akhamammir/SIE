<p-growl [value]="G" life="1500"></p-growl>
<p-confirmDialog header="Confirme" icon="fa fa-question-circle" width="425"></p-confirmDialog>
<p-dialog header="Modificar" [(visible)]="Dis" [responsive]="true">
    <p-steps [model]="Items" [(activeIndex)]="activeIndex" [style]="{'margin-left': '45%'}"></p-steps>
    <div *ngIf="activeIndex==0">
        <label class="Usr">Ingrese datos del Responsable de envio:</label>
        <input class="facer" [(ngModel)]="Provided[5]" placeholder="Nombre de Responable" style="margin:.1cm; width:95%;" required="true"/>
        <input class="facer" [(ngModel)]="Provided[6]" placeholder="Telefono de contacto" style="margin:.1cm; width:95%;" required="true"/>
        <input class="facer" [(ngModel)]="Provided[7]" placeholder="Email del responsable" style="margin:.1cm; width:95%;" required="true"/>
    </div>
    <div *ngIf="activeIndex!=0">
        <label class="Usr">Ingrese datos de Entrega:</label>
        <input class="facer" [(ngModel)]="Delivered[0]" placeholder="Lugar de Entrega" style="margin:.1cm; width:95%;" required="true"/>
        <input class="facer" [(ngModel)]="Delivered[1]" placeholder="Nombre de Responable" style="margin:.1cm; width:95%;" required="true"/>
        <input class="facer" [(ngModel)]="Delivered[2]" placeholder="Direccion de Entrega" style="margin:.1cm; width:95%;" required="true"/>
        <input class="facer" [(ngModel)]="Delivered[3]" placeholder="Colonia" style="margin:.1cm; width:95%;" required="true"/>
        <input class="facer" [(ngModel)]="Delivered[4]" placeholder="Estado" style="margin:.1cm; width:95%;" required="true"/>
        <input class="facer" [(ngModel)]="Delivered[5]" placeholder="Ciudad" style="margin:.1cm; width:95%;" required="true"/>
        <input class="facer" [(ngModel)]="Delivered[6]" placeholder="Telefono de contacto" style="margin:.1cm; width:95%;" required="true"/>
        <input class="facer" [(ngModel)]="Delivered[7]" placeholder="Email del responsable" style="margin:.1cm; width:95%;" required="true"/>
    </div>
    <button type="button" pButton (click)="activeIndex=1;Ecosta=false" icon="fa fa-send" label="Sig." style="cursor:pointer;float:left;" *ngIf="activeIndex==0"></button>
    <button type="button" pButton (click)="Ecosta=true;Build()" icon="fa fa-send" label="Entrega en Ecosta" style="cursor:pointer;float:left;" *ngIf="activeIndex==0"></button>
    <button type="button" pButton (click)="Build();" icon="fa fa-send" label="OK" style="cursor:pointer;float:left;" *ngIf="activeIndex!=0"></button>
</p-dialog>
<br/><br/><br/><br/><br/>
<p-fieldset legend="Lista de Comprados">
    <p-overlayPanel #op (mouseleave)="op.hide()" (blur)="op.hide()" [dismissable]="true">
        d
    </p-overlayPanel>
    <p-table [columns]="Cols" [value]="Gen" [rows]="25" [paginator]="true">
        <ng-template pTemplate="caption">
            <label class="Usr">Buscador avanzado:</label>
            <div class="ui-inputgroup">
                <p-chips [(ngModel)]="F" (ngModelChange)="Filter($event)" [style]="{'width':'90rem'}"></p-chips>
                <p-selectButton [options]="Kolors" [(ngModel)]="Colors" (ngModelChange)="Colorer()" multiple="multiple"></p-selectButton>
            </div>
        </ng-template>
       <ng-template pTemplate="header" let-columns>
        <tr>
            <th style="width:4.5rem;">
                O. de F.
            </th>
            <th style="width:6rem;">
                Cliente
            </th>
            <th style="width:4.8rem;">
                Cantidad
            </th>
            <th style="width:8rem;">
                No de Parte
            </th>
            <th style="width:23rem;">
                Descripcion
            </th>
            <th style="width:8rem;">
                Proveedor Sugerido
            </th>
            <th style="width:8rem;">
                Precio Venta
            </th>
            <th style="width:4.5rem;">
                Moneda Venta
            </th>
            <th style="width:13rem;">
                Comentarios Vendedor
            </th>
            <th style="width:8rem;">
                Precio Compra
            </th>
            <th style="width:8rem;">
                Proveedor Real
            </th>
            <th style="width:4.5rem;">
                Moneda Compra
            </th>
            <th style="width:4.5rem;">
                Tasa Cambio
            </th>
            <th style="width:5rem;">
                Gastos Envio
            </th>
            <th style="width:5rem;">
                T. de Entrega
            </th>
            <th style="width:4.9rem;">
                Comision
            </th>
            <th style="width:8rem;">
                Importe
            </th>
            <th style="width:8rem;">
                Subtotal
            </th>
            <th style="width:8rem;">
                No. Pedido
            </th>
            <th style="width:13rem;">
                Comentario Comprador
            </th>
            <th style="width:8rem;">
                Fecha
            </th>
            <th style="width:8rem;">
                Tiempo Transcurrido
            </th>
            <th style="width:5rem;" [pSortableColumn]="Cols[22].field">
                Compra
                <p-sortIcon [field]="Cols[22].field"></p-sortIcon>
            </th>
            <th style="width:5rem;" [pSortableColumn]="Cols[23].field">
                Envio
                <p-sortIcon [field]="Cols[23].field"></p-sortIcon>
            </th>
            <th style="width:5rem;" [pSortableColumn]="Cols[24].field">
                Alta
                <p-sortIcon [field]="Cols[24].field"></p-sortIcon>
            </th>
            <th style="width:5rem;" [pSortableColumn]="Cols[25].field">
                Entrega
                <p-sortIcon [field]="Cols[25].field"></p-sortIcon>
            </th>
            <th style="width:5rem;" [pSortableColumn]="Cols[26].field">
                Factura
                <p-sortIcon [field]="Cols[26].field"></p-sortIcon>
            </th>
            <th style="width:20rem;">
                Acciones
            </th>
        </tr>
    </ng-template>
    <ng-template pTemplate="body" let-rowData let-columns="columns">
        <tr>
            <td>
                {{rowData.MID}}
            </td>
            <td>
                {{rowData.Cli}}
            </td>
            <td>
                {{rowData.Cant}}
            </td>
            <td>
                {{rowData.Unit}}
            </td>
            <td>
                {{rowData.Desc}}
            </td>
            <td>
                {{rowData.Prov}}
            </td>
            <td>
                {{rowData.CInicial | currency:'USD':true:'1.2-2'}}
            </td>
            <td>
                {{rowData.Mon ? 'Dolares' : 'Pesos' }}
            </td>
            <td>
                {{rowData.Comm}}
            </td>
            <td>
                {{rowData.CCompra | currency:'USD':true:'1.2-2'}}
            </td>
            <td>
                {{rowData.PReal}}
            </td>
            <td>
                {{rowData.MonC ? 'Dolares' : 'Pesos' }}
            </td>
            <td>
                {{rowData.TdC}}
            </td>
            <td>
                {{rowData.GdE}}
            </td>
            <td>
                {{rowData.TdE}}
            </td>
            <td>
                {{rowData.Commit}}
            </td>
            <td>
                {{Nani(rowData.CFin) ? (rowData.CFin/rowData.Cant | currency:'USD':true:'1.2-2') : 0}}
            </td>
            <td>
                {{Nani(rowData.CFin) ? (rowData.CFin | currency:'USD':true:'1.2-2') : 0}}
            </td>
            <td>
                {{rowData.Pedido}}
            </td>
            <td>
                {{rowData.Com}}
            </td>
            <td>
                {{ rowData.Date| date:'mediumDate'}}
            </td>
            <td>
                Hace {{DateR(rowData.Date, rowData.ID)}} dias
            </td>
            <td>
                <p-checkbox styleClass="ViewChk" [(ngModel)]="rowData.Bought" binary="true" [disabled]="true"></p-checkbox>
            </td>
            <td>
                <p-checkbox styleClass="ViewChk" [(ngModel)]="rowData.Sent" binary="true" [disabled]="true"></p-checkbox>
            </td>
            <td>
                <p-checkbox styleClass="ViewChk" [(ngModel)]="rowData.Highed" binary="true" [disabled]="true"></p-checkbox>
            </td>
            <td>
                <p-checkbox styleClass="ViewChk" [(ngModel)]="rowData.Delivered" binary="true" [disabled]="true"></p-checkbox>
            </td>
            <td>
                <p-checkbox styleClass="ViewChk" [(ngModel)]="rowData.Facted" binary="true" [disabled]="true"></p-checkbox>
            </td>
            <td>
                <div class="ui-inputgroup" style="margin:.1cm;">
                    <button type="button" pButton (click)="OCer(rowData.PO)" label="Ver OC" style="cursor:pointer;float:left;" [disabled]="rowData.PO == undefined"></button>
                </div>
            </td>
        </tr>
    </ng-template>
    </p-table>
</p-fieldset>